; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

[Setup]
AppName=@APP_NAME@ model @APP_VERSION@
AppVersion=@APP_VERSION@
AppVerName=@APP_NAME@ model version @APP_VERSION@
AppPublisher=The UniDic Consortium.
AppPublisherURL=http://www.tokuteicorpus.jp/dist/
AppSupportURL=http://www.tokuteicorpus.jp/dist/
AppUpdatesURL=http://www.tokuteicorpus.jp/dist/
AppCopyright=Copyright (C) 2010-2011 The UniDic Consortium.
; WindowVisible=no
; WizardImageFile=img\comainu.bmp
; WizardSmallImageFile=img\comainu.bmp
DefaultDirName={pf}\@APP_NAME@\@APP_VERSION@
UsePreviousAppDir=no
DefaultGroupName=@APP_NAME@ @APP_VERSION@
UsePreviousGroup=no
SourceDir=dist\@APP_NAME@-@APP_VERSION@
LicenseFile=train\License.txt
; InfoBeforeFile=Environment.txt
; InfoAfterFile=Readme.txt
OutputDir=..
OutputBaseFilename=setup
Compression=bzip/9
ChangesAssociations=yes
UninstallDisplayIcon={app}\bin\runcom.exe
; MessagesFile=compiler:Japanese-3.0.5.isl
; MessagesFile=compiler:Japanese-2-3.0.5.isl
ShowLanguageDialog=no

[Languages]
Name: "en"; MessagesFile: "compiler:Default.isl"
Name: "ja"; MessagesFile: "compiler:Languages\Japanese.isl";

[Tasks]
Name: common; Description: "全ユーザ共通 (&A)"; GroupDescription: "インストールユーザ:"; Flags: exclusive unchecked
Name: user;  Description: "現在のユーザ (&U)"; GroupDescription: "インストールユーザ:"; Flags: exclusive
; Name: "desktopicon"; Description: "デスクトップアイコンを作成する(&D)"; GroupDescription: "追加タスク："
; Name: "changeassoc"; Description: "データファイル(*.csp)を関連付ける(&F)"; GroupDescription: "追加タスク："

[Files]
Source: "*"; DestDir: "{app}"; Flags: ignoreversion recursesubdirs;
; Source: "Readme.txt"; DestDir: "{app}"; Flags: isreadme;
; Source: "License.txt"; DestDir: "{app}";
; NOTE: Don't use "Flags: ignoreversion" on any shared system files

[Code]
function DefAppDataFolder(Param: String): String;
begin
  if IsTaskSelected('common') then
    Result := ExpandConstant('{commonappdata}')
  else
    Result := ExpandConstant('{userappdata}')
end;
function DefDesktop(Param: String): String;
begin
  if IsTaskSelected('common') then
    Result := ExpandConstant('{commondesktop}')
  else
    Result := ExpandConstant('{userdesktop}')
end;

[Icons]
Name: "{group}\7. {groupname} model License"; Filename: "{app}\train\License.txt"
Name: "{group}\8. Uninstall {groupname} model"; Filename: "{uninstallexe}"

[Run]

[UninstallDelete]

[Registry]
; Root: HKCR; Subkey: ".csp"; ValueType: string; ValueName: ""; ValueData: "@APP_NAME@.File"; Tasks: "changeassoc"; Flags: uninsdeletevalue 
; Root: HKCR; Subkey: ".csp"; ValueType: string; ValueName: "Content Type"; ValueData: "application/x-csp-file"; Tasks: "changeassoc"; Flags: uninsdeletevalue 
; Root: HKCR; Subkey: "@APP_NAME@.File"; ValueType: string; ValueName: ""; ValueData: "@APP_NAME@ File";  Tasks: "changeassoc"; Flags: uninsdeletekey 
; Root: HKCR; Subkey: "@APP_NAME@.File\DefaultIcon"; ValueType: string; ValueName: ""; ValueData: "{app}\bin\runcom.exe,0"; Tasks: "changeassoc"
; Root: HKCR; Subkey: "@APP_NAME@.File\shell\open\command"; ValueType: string; ValueName: ""; ValueData: """{app}\bin\runcom.exe"" ""%1"""; Tasks: "changeassoc"
